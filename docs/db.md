### 1.用户表

```sql
DROP TABLE IF EXISTS users;

CREATE TABLE users (
    -- ID主键，使用 PG 的 IDENTITY 特性替代 Auto Increment
    id              BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,

    -- 核心账号信息
    username        VARCHAR(50) NOT NULL,          -- 昵称
    password        VARCHAR(255) NOT NULL,         -- 你的业务逻辑要求注册时必须设置密码
    email           VARCHAR(100) NOT NULL,         -- 核心唯一凭证
    phone           VARCHAR(20),                   -- 手机号

    -- 第三方登录关联 ID (单表设计的核心)
    -- 只有当用户使用对应方式登录时，这些字段才有值，否则为 NULL
    google_id       VARCHAR(100),                  -- Google OpenID / Sub
    x_id            VARCHAR(100),                  -- X (Twitter) ID
    github_id       VARCHAR(100),                  -- Github ID

    -- 用户资料
    avatar_url      VARCHAR(500),
    gender          SMALLINT DEFAULT 0,            -- 0=未知，1=男，2=女
    birthdate       DATE,

    -- 状态与权限
    status          SMALLINT DEFAULT 1,            -- 1=启用，0=禁用
    role            SMALLINT DEFAULT 0,            -- 0=用户，1=管理员
    deleted         SMALLINT DEFAULT 0,            -- 0=正常，1=已删除

    -- 时间字段 (去掉了 ON UPDATE，由代码控制)
    create_time     TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    update_time     TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- 添加列注释
COMMENT ON COLUMN users.id IS 'ID';
COMMENT ON COLUMN users.username IS '用户名/昵称';
COMMENT ON COLUMN users.password IS '加密后的密码';
COMMENT ON COLUMN users.email IS '邮箱(唯一凭证)';
COMMENT ON COLUMN users.google_id IS 'Google平台唯一ID';
COMMENT ON COLUMN users.x_id IS 'X/Twitter平台唯一ID';
COMMENT ON COLUMN users.github_id IS 'Github平台唯一ID';
COMMENT ON COLUMN users.status IS '状态：0=禁用，1=启用';
COMMENT ON COLUMN users.deleted IS '逻辑删除：0=正常，1=已删除';

-- === 索引优化 (性能关键) ===

-- 1. 邮箱必须唯一，且查询最频繁
CREATE UNIQUE INDEX idx_users_email ON users(email);

-- 2. 第三方登录 ID 索引
-- 当用户点击 "Google登录" 时，你需要通过 google_id 快速查表
-- 如果查不到，再拿邮箱去查 email 索引
CREATE INDEX idx_users_google_id ON users(google_id);
CREATE INDEX idx_users_x_id ON users(x_id);
CREATE INDEX idx_users_github_id ON users(github_id);

-- 3. 辅助索引 (可选，根据后台管理查询需求决定)
CREATE INDEX idx_users_phone ON users(phone);
```